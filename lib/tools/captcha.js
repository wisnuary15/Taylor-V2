import sharp from "sharp";
import Jimp from "jimp";
import crypto from "crypto";
class CaptchaV1 {
  _buf(image) {
    return new Promise(function(resolve) {
      image.getBuffer(Jimp.MIME_PNG, function(err, buf) {
        resolve(buf);
      });
    });
  }
  _randomInt(low, high) {
    return Math.floor(Math.random() * (high - low) + low);
  }
  async get(code) {
    this.font1 || (this.font1 = await Jimp.loadFont(Jimp.FONT_SANS_16_BLACK));
    let image = await new Jimp(120, 50, 4294967295);
    for (let x = 0; x < 120; x++)
      for (let y = 0; y < 50; y++) 1 === this._randomInt(0, 10) && image.setPixelColor(255, x, y);
    image.pixelate(2);
    let idx = 0;
    for (let chr of code) {
      let y = -2,
        x = 20 * idx + this._randomInt(0, 7);
      image.print(this.font1, x, y, chr), image.rotate(this._randomInt(0, 5)),
        image.scale(1.1), image.crop(0, 0, 120, 50), idx++;
    }
    for (let x = 0; x < 120; x++)
      for (let y = 0; y < 50; y++) 1 === this._randomInt(0, 20) && image.setPixelColor(2576980479, x, y);
    return image.rotate(this._randomInt(-3, 3)), image.scale(1.3), image.crop(0, 0, 120, 50),
      await this._buf(image);
  }
}
export const generateV1 = async (length = 4) => {
  try {
    const code = utils.generateRandomCode(length),
      client = new CaptchaV1();
    return {
      buffer: await client.get(code),
      code: code
    };
  } catch (error) {
    throw console.error("Error generating CAPTCHA:", error), new Error("Failed to generate CAPTCHA");
  }
};
const utils = {
    getImageBuffer: image => new Promise((resolve, reject) => image.getBuffer(Jimp.MIME_PNG, (err, buf) => {
      err ? reject(err) : resolve(buf);
    })),
    getRandomInt: (low, high) => Math.floor(Math.random() * (high - low) + low),
    generateRandomCode: length => {
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
      let result = "";
      for (let i = 0; i < length; i++) {
        result += chars[crypto.randomInt(0, 62)];
      }
      return result;
    }
  },
  backgroundCharsDefault = [..."0123456789"],
  backgroundColorDefault = 4294967295;
export const generate = async (length = 4, backgroundChars = backgroundCharsDefault, backgroundColor = 4294967295) => {
  try {
    const code = utils.generateRandomCode(length),
      font = await Jimp.loadFont(Jimp.FONT_SANS_32_BLACK),
      image = new Jimp(30 * length + 30, 50, backgroundColor),
      cimage = new Jimp(30, 30, 4294967040),
      x = utils.getRandomInt(20, 30);
    for (let i = 0; i < code.length; i++) {
      const cp = code[i],
        chr = backgroundChars[utils.getRandomInt(0, backgroundChars.length)];
      await cimage.crop(0, 0, 30, 30).print(font, 0, 0, chr).rotate(utils.getRandomInt(1, 60), !0).opacity(.6).print(font, 0, 0, cp).resize(20, 20, Jimp.RESIZE_BEZIER).rotate(utils.getRandomInt(1, 15)).resize(utils.getRandomInt(40, 42), utils.getRandomInt(40, 42), Jimp.RESIZE_HERMITE).opacity(.8).dither16(),
        image.composite(cimage, x + 20 * i - utils.getRandomInt(5, 10), utils.getRandomInt(2, 8));
    }
    image.autocrop();
    return {
      buffer: await utils.getImageBuffer(image),
      code: code
    };
  } catch (error) {
    throw console.error("Error generating CAPTCHA:", error), new Error("Failed to generate CAPTCHA");
  }
};
const colors = ["GIF89aÈ\0F\0\0\0\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\nôC6\nôC6\nôC6\nôC6\nôC6\nôC6\nôC6\nôC6\nôC6\nôC6\nôC6\nôC6\nôC6\nôC6\nôC6\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\néc\néc\néc\néc\néc\néc\néc\néc\néc\néc\néc\néc\néc\néc\néc\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\n'°\n'°\n'°\n'°\n'°\n'°\n'°\n'°\n'°\n'°\n'°\n'°\n'°\n'°\n'°\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\ng:·\ng:·\ng:·\ng:·\ng:·\ng:·\ng:·\ng:·\ng:·\ng:·\ng:·\ng:·\ng:·\ng:·\ng:·\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\n?Qµ\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\n!ó\n!ó\n!ó\n!ó\n!ó\n!ó\n!ó\n!ó\n!ó\n!ó\n!ó\n!ó\n!ó\n!ó\n!ó\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\n©ô\n©ô\n©ô\n©ô\n©ô\n©ô\n©ô\n©ô\n©ô\n©ô\n©ô\n©ô\n©ô\n©ô\n©ô\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\n\0¼Ô\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\n\0\n\0\n\0\n\0\n\0\n\0\n\0\n\0\n\0\n\0\n\0\n\0\n\0\n\0\n\0\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nL¯P\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÃJ\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÍÜ9\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿë;\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÁ\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿ\0\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿW\"\nÿÿÿ,\0\0\0\0È\0F\0\0", "GIF89aÈ\0F\0\0\0\nyUH\nyUH\nyUH\nyUH\nyUH\nyUH\nyUH\nyUH\nyUH\nyUH\nyUH\nyUH\nyUH\nyUH\nyUH\nÿÿÿ,\0\0\0\0È\0F\0\0"],
  lt0 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -4, 11, 7, 5, 3, 1, 0, 0, 0, 1, 3, 7, 13, -100, -2, 11, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, -1, 7, 0, 0, 0, 0, 0, 0, 3, 9, 11, 9, 3, 0, 0, 0, 0, 13, -100, 9, 0, 0, 0, 0, 0, 0, 3, -5, 3, 0, 0, 0, 7, -100, 5, 0, 0, 0, 0, 0, 1, 13, -5, 9, 0, 0, 0, 1, -100, 7, 0, 0, 0, 0, 1, 13, -6, 13, 0, 0, 0, 0, -100, -1, 9, 1, 0, 5, 13, -8, 0, 0, 0, 0, 13, -100, -14, 0, 0, 0, 0, 11, -100, -14, 0, 0, 0, 0, 11, -100, -14, 0, 0, 0, 0, 11, -100, -12, 13, 5, 0, 0, 0, 0, 11, -100, -8, 13, 9, 5, 1, 0, 0, 0, 0, 0, 0, 11, -100, -4, 13, 7, 3, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 11, -100, -2, 13, 5, 0, 0, 0, 0, 0, 5, 9, 13, -2, 0, 0, 0, 0, 11, -100, -1, 13, 1, 0, 0, 0, 0, 7, -6, 0, 0, 0, 0, 11, -100, 13, 1, 0, 0, 0, 0, 13, -7, 0, 0, 0, 0, 11, -100, 5, 0, 0, 0, 0, 5, -8, 0, 0, 0, 0, 11, -100, 0, 0, 0, 0, 0, 11, -8, 0, 0, 0, 0, 11, -100, 0, 0, 0, 0, 0, 13, -7, 13, 0, 0, 0, 0, 11, -100, 1, 0, 0, 0, 0, -7, 9, 0, 0, 0, 0, 0, 9, -3, 9, -100, 5, 0, 0, 0, 0, 3, 13, -3, 11, 3, 0, 0, 0, 0, 0, 0, 0, 9, 13, 3, 5, -100, 13, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 11, 9, 0, 0, 0, 0, 0, 0, 1, 13, -100, -1, 11, 1, 0, 0, 0, 0, 0, 0, 0, 0, 5, -3, 9, 0, 0, 0, 0, 0, 11, -100, -2, 13, 7, 3, 0, 0, 0, 3, 7, 13, -5, 9, 0, 1, 3, 9, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt1 = [-100, -100, -4, 13, 5, 0, 3, -100, -3, 11, 1, 0, 0, 0, 7, -100, -2, 7, 0, 0, 0, 0, 0, 3, -100, 13, 3, 0, 0, 0, 0, 0, 0, 5, -100, 1, 0, 0, 0, 0, 0, 0, 0, 9, -100, 1, 0, 0, 0, 0, 0, 0, 0, 13, -100, 13, 3, 0, 0, 0, 0, 0, 1, -100, -2, 5, 0, 0, 0, 0, 5, -100, -3, 0, 0, 0, 0, 9, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 9, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 3, 13, 9, 5, 3, 1, 0, 0, 1, 3, 5, 9, -100, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 13, -100, -3, 0, 0, 0, 0, 0, 5, 13, -2, 13, 11, 9, 5, 0, 0, 0, 0, 1, 13, -100, -3, 0, 0, 0, 0, 1, -8, 13, 1, 0, 0, 0, 5, -100, -3, 3, 0, 0, 0, 5, -9, 13, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 9, -10, 7, 0, 0, 0, 5, -100, -3, 1, 0, 0, 0, 11, -10, 13, 0, 0, 0, 0, -100, -3, 3, 0, 0, 0, 11, -11, 3, 0, 0, 0, 11, -100, -3, 1, 0, 0, 0, 11, -11, 7, 0, 0, 0, 7, -100, -3, 0, 0, 0, 0, 11, -11, 9, 0, 0, 0, 3, -100, -3, 0, 0, 0, 0, 11, -11, 11, 0, 0, 0, 1, -100, -3, 0, 0, 0, 0, 11, -11, 11, 0, 0, 0, 1, -100, -3, 0, 0, 0, 0, 11, -11, 11, 0, 0, 0, 0, -100, -3, 0, 0, 0, 0, 11, -11, 9, 0, 0, 0, 0, -100, -3, 0, 0, 0, 0, 11, -11, 7, 0, 0, 0, 3, -100, -3, 0, 0, 0, 0, 11, -11, 3, 0, 0, 0, 7, -100, -3, 0, 0, 0, 0, 11, -11, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -10, 9, 0, 0, 0, 3, -100, -3, 0, 0, 0, 0, 9, -10, 3, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 3, -9, 11, 0, 0, 0, 5, -100, -2, 13, 0, 0, 0, 0, 0, 9, -7, 11, 1, 0, 0, 3, -100, -2, 7, 0, 0, 0, 0, 0, 0, 7, 13, -2, 13, 9, 3, 0, 0, 0, 3, 13, -100, -2, 13, 0, 0, 5, 13, 11, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, -100, -3, 9, 11, -4, 7, 3, 1, 0, 0, 1, 5, 9, 13, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt2 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -6, 13, 7, 3, 1, 0, 0, 1, 3, 7, 13, -100, -5, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 13, -100, -3, 13, 3, 0, 0, 0, 5, 13, 13, 7, 0, 0, 0, 0, 0, 1, 13, -100, -2, 13, 1, 0, 0, 0, 9, -4, 7, 0, 0, 0, 0, 0, 1, -100, -1, 13, 1, 0, 0, 0, 9, -6, 5, 0, 0, 0, 0, 0, 13, -100, -1, 5, 0, 0, 0, 3, -8, 1, 0, 0, 0, 3, -100, 13, 0, 0, 0, 0, 11, -8, 13, 3, 0, 3, -100, 7, 0, 0, 0, 1, -100, 5, 0, 0, 0, 5, -100, 3, 0, 0, 0, 9, -100, 1, 0, 0, 0, 11, -100, 0, 0, 0, 0, 11, -100, 0, 0, 0, 0, 11, -100, 0, 0, 0, 0, 11, -100, 0, 0, 0, 0, 9, -100, 1, 0, 0, 0, 5, -100, 5, 0, 0, 0, 0, 13, -100, 11, 0, 0, 0, 0, 7, -100, -1, 3, 0, 0, 0, 0, 13, -100, -1, 11, 0, 0, 0, 0, 3, -12, 9, -100, -2, 7, 0, 0, 0, 0, 3, 13, -8, 9, 1, 3, -100, -3, 5, 0, 0, 0, 0, 1, 9, -5, 9, 3, 0, 0, 11, -100, -4, 5, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 11, -100, -5, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 13, -100, -7, 11, 7, 3, 1, 0, 1, 3, 7, 11, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt3 = [-100, -100, -100, -100, -18, 11, 3, 0, -100, -16, 13, 3, 0, 0, 0, -100, -14, 9, 3, 0, 0, 0, 0, 0, -100, -13, 3, 0, 0, 0, 0, 0, 0, 0, -100, -13, 0, 0, 0, 0, 0, 0, 0, 0, -100, -13, 9, 1, 0, 0, 0, 0, 0, 0, -100, -15, 13, 5, 0, 0, 0, 0, -100, -17, 1, 0, 0, 0, -100, -17, 3, 0, 0, 0, -100, -17, 1, 0, 0, 0, -100, -17, 0, 0, 0, 0, -100, -16, 13, 0, 0, 0, 0, -100, -16, 13, 0, 0, 0, 0, -100, -6, 11, 5, 3, 1, 0, 0, 1, 5, 9, 13, 13, 0, 0, 0, 0, -100, -4, 13, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, -100, -3, 13, 1, 0, 0, 0, 0, 5, 11, -1, 13, 11, 3, 0, 0, 0, 0, 0, 0, -100, -2, 13, 1, 0, 0, 0, 0, 7, -6, 11, 0, 0, 0, 0, 0, -100, -2, 3, 0, 0, 0, 0, 9, -8, 11, 0, 0, 0, 0, -100, -1, 9, 0, 0, 0, 0, 7, -9, 11, 0, 0, 0, 0, -100, -1, 1, 0, 0, 0, 0, 13, -9, 11, 0, 0, 0, 0, -100, 11, 0, 0, 0, 0, 3, -10, 11, 0, 0, 0, 0, -100, 5, 0, 0, 0, 0, 13, -10, 11, 0, 0, 0, 0, -100, 3, 0, 0, 0, 3, -11, 11, 0, 0, 0, 0, -100, 0, 0, 0, 0, 7, -11, 11, 0, 0, 0, 0, -100, 0, 0, 0, 0, 11, -11, 11, 0, 0, 0, 0, -100, 0, 0, 0, 0, 11, -11, 11, 0, 0, 0, 0, -100, 0, 0, 0, 0, 11, -11, 11, 0, 0, 0, 0, -100, 1, 0, 0, 0, 9, -11, 11, 0, 0, 0, 0, -100, 3, 0, 0, 0, 7, -11, 11, 0, 0, 0, 0, -100, 7, 0, 0, 0, 3, -11, 11, 0, 0, 0, 0, -100, 13, 0, 0, 0, 0, 13, -10, 13, 0, 0, 0, 0, -100, -1, 3, 0, 0, 0, 5, -11, 0, 0, 0, 0, -100, -1, 13, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, -100, -2, 7, 0, 0, 0, 1, 13, -8, 13, 0, 0, 0, 0, 13, -100, -3, 5, 0, 0, 0, 1, 11, -7, 5, 0, 0, 0, 0, 9, -100, -4, 5, 0, 0, 0, 0, 3, 9, 13, -1, 13, 11, 1, 0, 0, 0, 0, 0, 0, 0, 5, -100, -5, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 1, 13, -100, -7, 9, 3, 1, 0, 0, 3, 7, 13, -1, 11, 1, 0, 1, 5, 7, 11, -100, -18, 13, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt4 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -7, 13, 5, 1, 1, 0, 1, 3, 9, 13, -100, -6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, -4, 11, 1, 0, 0, 3, 11, -1, 13, 7, 1, 0, 0, 0, 9, -100, -3, 9, 0, 0, 0, 1, 13, -5, 3, 0, 0, 1, -100, -2, 9, 0, 0, 0, 0, 13, -6, 11, 0, 0, 0, 9, -100, -1, 13, 0, 0, 0, 0, 9, -8, 0, 0, 0, 1, -100, -1, 5, 0, 0, 0, 0, 13, -8, 3, 0, 0, 0, 11, -100, -1, 0, 0, 0, 0, 0, -8, 13, 1, 0, 0, 0, 5, -100, 9, 0, 0, 0, 0, 0, 3, 11, -4, 13, 11, 1, 0, 0, 0, 0, 1, -100, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -100, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, -100, 1, 0, 0, 0, 1, 13, -100, 0, 0, 0, 0, 11, -100, 0, 0, 0, 0, 11, -100, 1, 0, 0, 0, 9, -100, 3, 0, 0, 0, 7, -100, 7, 0, 0, 0, 5, -100, 13, 0, 0, 0, 0, 11, -100, -1, 5, 0, 0, 0, 1, 13, -100, -1, 13, 1, 0, 0, 0, 1, 13, -10, 13, 11, -100, -2, 11, 0, 0, 0, 0, 1, 13, -8, 13, 1, 1, -100, -3, 11, 0, 0, 0, 0, 0, 7, 13, -4, 11, 7, 0, 0, 9, -100, -4, 11, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 7, -100, -5, 13, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 9, -100, -7, 13, 7, 3, 0, 0, 0, 1, 5, 9, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt5 = [-100, -100, -100, -100, -9, 13, 9, 3, 1, 0, 1, 5, 13, -100, -8, 7, 0, 0, 0, 0, 0, 0, 0, 3, -100, -7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 1, -100, -6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, -100, -5, 13, 0, 0, 3, 13, 9, 1, 0, 0, 0, 0, 11, -100, -5, 9, 0, 0, 13, -2, 13, 5, 0, 1, 9, -100, -5, 5, 0, 0, -100, -5, 1, 0, 1, -100, -5, 1, 0, 0, -100, -5, 0, 0, 0, -100, -5, 0, 0, 0, 13, -100, -5, 0, 0, 0, 9, -100, -5, 0, 0, 0, 7, -100, -5, 0, 0, 0, 5, -100, -3, 13, 7, 0, 0, 0, 0, 9, -1, 13, 11, 13, -100, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, -1, 11, 13, -1, 7, 0, 0, 0, 0, 5, -1, 13, 11, 13, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 11, -100, -5, 0, 0, 0, 0, 7, -100, -3, 13, 5, 0, 0, 0, 0, 0, 7, 13, -100, -1, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 11, -100, -1, 7, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 7, 13, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt6 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -7, 11, 7, 3, 1, 0, 0, 1, 3, 7, 13, -4, 13, 7, 5, 7, 11, -100, -5, 11, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 13, 13, 5, 0, 0, 0, 0, 0, -100, -4, 9, 0, 0, 0, 5, 13, -1, 13, 9, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -100, -3, 11, 0, 0, 0, 5, -6, 5, 0, 0, 0, 0, 0, 11, 13, 9, 3, 0, 9, -100, -2, 13, 0, 0, 0, 0, 13, -7, 1, 0, 0, 0, 0, 13, -100, -2, 1, 0, 0, 0, 7, -8, 7, 0, 0, 0, 0, 7, -100, -2, 0, 0, 0, 0, 9, -8, 11, 0, 0, 0, 0, 3, -100, -2, 0, 0, 0, 0, 11, -9, 0, 0, 0, 0, 1, -100, -2, 0, 0, 0, 0, 11, -9, 0, 0, 0, 0, 0, -100, -2, 0, 0, 0, 0, 9, -8, 13, 0, 0, 0, 0, 1, -100, -2, 3, 0, 0, 0, 5, -8, 9, 0, 0, 0, 0, 7, -100, -2, 13, 1, 0, 0, 0, 13, -7, 5, 0, 0, 0, 0, 13, -100, -3, 11, 0, 0, 0, 3, 13, -5, 7, 0, 0, 0, 0, 11, -100, -4, 7, 0, 0, 0, 1, 9, 13, -1, 13, 7, 0, 0, 0, 1, 11, -100, -4, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 13, -100, -4, 13, 0, 0, 0, 0, 0, 0, 1, 3, 5, 9, -100, -2, 13, 5, 0, 11, -100, -1, 13, 1, 0, 0, -100, -1, 3, 0, 0, 0, 1, 7, 13, -100, -1, 0, 0, 0, 0, 0, 0, 0, 1, 3, 7, 9, 11, 13, -100, -1, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 5, 11, -100, -2, 11, 7, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 11, -100, -4, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, -3, 9, 1, 0, 3, 9, 13, 13, 11, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, -100, -1, 7, 1, 0, 0, 9, -8, 11, 7, 3, 0, 0, 0, 0, 0, 5, -100, 9, 0, 0, 0, 3, -13, 11, 1, 0, 0, 1, -100, 1, 0, 0, 0, 9, -15, 0, 0, 0, -100, 0, 0, 0, 0, 9, -14, 13, 0, 0, 1, -100, 3, 0, 0, 0, 1, -14, 7, 0, 0, 5, -100, 11, 0, 0, 0, 0, 5, -12, 11, 0, 0, 0, 13, -100, -1, 11, 1, 0, 0, 0, 1, 7, 11, 13, -1, 13, 13, 11, 9, 5, 3, 1, 0, 0, 3, 13, -100, -3, 9, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 9, -100, -6, 9, 7, 3, 1, 1, 0, 0, 1, 1, 3, 7, 11, -100, -101],
  lt7 = [-100, -100, -100, -100, -4, 13, 7, 1, 9, -100, -2, 13, 7, 0, 0, 0, 3, -100, -1, 7, 0, 0, 0, 0, 0, 5, -100, 1, 0, 0, 0, 0, 0, 0, 7, -100, 3, 0, 0, 0, 0, 0, 0, 7, -100, 13, 7, 0, 0, 0, 0, 0, 9, -100, -2, 5, 0, 0, 0, 0, 9, -100, -2, 11, 0, 0, 0, 0, 9, -100, -3, 0, 0, 0, 0, 9, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -5, 11, 5, 1, 0, 1, 7, -100, -3, 0, 0, 0, 0, 11, -3, 13, 3, 0, 0, 0, 0, 0, 0, 3, -100, -3, 0, 0, 0, 0, 11, -2, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, -3, 0, 0, 0, 0, 11, 11, 3, 0, 5, 11, -1, 13, 9, 1, 0, 0, 0, 3, -100, -3, 0, 0, 0, 0, 3, 0, 1, 11, -6, 1, 0, 0, 0, 13, -100, -3, 0, 0, 0, 0, 0, 5, -8, 11, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -10, 0, 0, 0, 7, -100, -3, 0, 0, 0, 0, 13, -10, 0, 0, 0, 7, -100, -3, 0, 0, 0, 0, 11, -10, 0, 0, 0, 7, -100, -3, 0, 0, 0, 0, 11, -10, 0, 0, 0, 7, -100, -3, 0, 0, 0, 0, 13, -10, 0, 0, 0, 9, -100, -3, 0, 0, 0, 0, 13, -10, 0, 0, 0, 9, -100, -3, 0, 0, 0, 0, -11, 0, 0, 0, 11, -100, -3, 0, 0, 0, 1, -11, 0, 0, 0, 13, -100, -3, 0, 0, 0, 1, -11, 0, 0, 0, 13, -100, -3, 0, 0, 0, 3, -11, 0, 0, 0, -100, -3, 0, 0, 0, 3, -11, 0, 0, 0, -100, -3, 0, 0, 0, 3, -11, 0, 0, 0, -100, -3, 0, 0, 0, 3, -10, 13, 0, 0, 0, 13, -100, -3, 0, 0, 0, 1, -10, 13, 0, 0, 0, 11, -100, -2, 9, 0, 0, 0, 0, -10, 11, 0, 0, 0, 5, -100, -1, 7, 0, 0, 0, 0, 0, 5, 13, -7, 13, 3, 0, 0, 0, 0, 7, -100, 5, 0, 0, 0, 0, 0, 0, 0, 0, 3, -5, 1, 0, 0, 0, 0, 0, 0, 1, 3, 11, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt8 = [-100, -100, -100, -100, -3, 5, 1, 0, 3, 11, -100, -2, 7, 0, 0, 0, 0, 0, 11, -100, -2, 1, 0, 0, 0, 0, 0, 5, -100, -2, 0, 0, 0, 0, 0, 0, 5, -100, -2, 5, 0, 0, 0, 0, 0, 11, -100, -3, 7, 0, 0, 3, 9, -100, -4, 13, -100, -100, -100, -100, -100, -100, -100, -4, 11, 3, 0, 9, -100, -2, 9, 3, 0, 0, 0, 9, -100, 11, 1, 0, 0, 0, 0, 0, 7, -100, 1, 0, 0, 0, 0, 0, 0, 7, -100, 1, 0, 0, 0, 0, 0, 0, 9, -100, -1, 11, 0, 0, 0, 0, 0, 9, -100, -2, 7, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 13, -100, -3, 1, 0, 0, 0, -100, -3, 1, 0, 0, 0, 13, -100, -3, 1, 0, 0, 0, 13, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -2, 13, 0, 0, 0, 0, 7, -100, -2, 13, 0, 0, 0, 0, 1, -100, -2, 7, 0, 0, 0, 0, 0, 9, -100, 7, 0, 0, 0, 0, 0, 0, 0, 0, 3, -100, 9, 5, 1, 1, 0, 0, 1, 1, 3, 5, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt9 = [-100, -100, -100, -100, -6, 5, 0, 1, 5, 13, -100, -5, 5, 0, 0, 0, 0, 1, -100, -5, 1, 0, 0, 0, 0, 0, 13, -100, -5, 0, 0, 0, 0, 0, 0, -100, -5, 5, 0, 0, 0, 0, 3, -100, -6, 7, 1, 0, 5, 13, -100, -100, -100, -100, -100, -100, -100, -100, -6, 13, 7, 3, 0, 13, -100, -5, 7, 0, 0, 0, 0, 11, -100, -3, 7, 1, 0, 0, 0, 0, 0, 11, -100, -2, 13, 0, 0, 0, 0, 0, 0, 0, 11, -100, -3, 11, 3, 0, 0, 0, 0, 0, 11, -100, -5, 9, 0, 0, 0, 0, 11, -100, -6, 1, 0, 0, 0, 11, -100, -6, 3, 0, 0, 0, 11, -100, -6, 5, 0, 0, 0, 11, -100, -6, 5, 0, 0, 0, 11, -100, -6, 5, 0, 0, 0, 11, -100, -6, 5, 0, 0, 0, 11, -100, -6, 3, 0, 0, 0, 11, -100, -6, 3, 0, 0, 0, 11, -100, -6, 1, 0, 0, 0, 11, -100, -6, 1, 0, 0, 0, 13, -100, -6, 1, 0, 0, 0, 13, -100, -6, 1, 0, 0, 0, 13, -100, -6, 1, 0, 0, 0, 13, -100, -6, 1, 0, 0, 0, 13, -100, -6, 1, 0, 0, 0, -100, -6, 1, 0, 0, 0, -100, -6, 1, 0, 0, 1, -100, -6, 1, 0, 0, 3, -100, -6, 0, 0, 0, 5, -100, -6, 0, 0, 0, 7, -100, -6, 0, 0, 0, 11, -100, 11, 0, 0, 0, 5, 5, 0, 0, 5, -100, 3, 0, 0, 0, 0, 0, 0, 3, -100, 0, 0, 0, 0, 0, 0, 0, 13, -100, 1, 0, 0, 0, 0, 0, 11, -100, 13, 3, 0, 0, 3, 11, -100, -100, -101],
  lt10 = [-100, -100, -100, -100, -6, 9, 1, 13, -100, -3, 13, 5, 0, 0, 0, 11, -100, -1, 13, 5, 0, 0, 0, 0, 0, 11, -100, 13, 1, 0, 0, 0, 0, 0, 0, 11, -100, 3, 0, 0, 0, 0, 0, 0, 0, 11, -100, 11, 3, 0, 0, 0, 0, 0, 0, 11, -100, -2, 13, 0, 0, 0, 0, 0, 11, -100, -3, 9, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, -100, -4, 0, 0, 0, 0, 11, -7, 5, 0, 0, 0, 0, 0, 0, 0, 1, 7, 13, -100, -4, 0, 0, 0, 0, 11, -8, 9, 0, 0, 0, 1, 9, -100, -4, 0, 0, 0, 0, 11, -7, 13, 1, 0, 0, 7, -100, -4, 0, 0, 0, 0, 11, -7, 5, 0, 3, 13, -100, -4, 0, 0, 0, 0, 11, -6, 5, 0, 5, -100, -4, 0, 0, 0, 0, 11, -5, 5, 1, 11, -100, -4, 0, 0, 0, 0, 11, -3, 11, 3, 1, -100, -4, 0, 0, 0, 0, 11, -1, 11, 3, 0, 0, 1, -100, -4, 0, 0, 0, 0, 11, 9, 0, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 3, -100, -4, 0, 0, 0, 0, 0, 9, -1, 11, 1, 0, 0, 0, 9, -100, -4, 0, 0, 0, 0, 5, -4, 3, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -4, 13, 1, 0, 0, 0, 13, -100, -4, 0, 0, 0, 0, 11, -5, 11, 0, 0, 0, 1, 13, -100, -4, 0, 0, 0, 0, 11, -6, 3, 0, 0, 0, 3, -100, -4, 0, 0, 0, 0, 11, -6, 11, 0, 0, 0, 0, 7, -100, -4, 0, 0, 0, 0, 11, -7, 3, 0, 0, 0, 0, 7, -100, -3, 13, 0, 0, 0, 0, 11, -7, 13, 0, 0, 0, 0, 0, 7, -100, -2, 13, 3, 0, 0, 0, 0, 7, -7, 9, 0, 0, 0, 0, 0, 0, 3, 11, -100, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, -100, -1, 7, 1, 0, 0, 0, 0, 0, 0, 0, 0, 7, -4, 3, 0, 0, 0, 0, 0, 0, 1, 1, 5, 9, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt11 = [-100, -100, -100, -6, 11, 7, 11, -100, -4, 11, 3, 0, 0, 5, -100, -3, 5, 0, 0, 0, 0, 5, -100, -1, 11, 1, 0, 0, 0, 0, 0, 7, -100, 7, 0, 0, 0, 0, 0, 0, 0, 7, -100, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, 7, 0, 0, 0, 0, 0, 0, 0, 9, -100, -2, 9, 1, 0, 0, 0, 0, 9, -100, -3, 11, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 7, -100, -3, 5, 0, 0, 0, 0, 0, 13, -100, -1, 9, 1, 0, 0, 0, 0, 0, 0, 0, 1, 9, -100, -1, 5, 1, 0, 0, 0, 0, 0, 0, 0, 1, 11, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt12 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -5, 11, 5, 0, -21, 7, 1, 0, 3, 9, -100, -4, 7, 0, 0, 0, 13, -4, 11, 5, 1, 1, 0, 1, 7, -7, 11, 3, 0, 0, 0, 0, 0, 5, -100, -2, 11, 1, 0, 0, 0, 0, 11, -2, 9, 1, 0, 0, 0, 0, 0, 0, 0, 9, -4, 13, 5, 0, 0, 0, 0, 0, 0, 0, 0, 7, -100, 13, 3, 0, 0, 0, 0, 0, 0, 7, 13, 3, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 7, -1, 13, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, -100, 3, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 5, 11, -3, 11, 0, 0, 0, 0, 0, 0, 0, 3, 9, 13, 13, -3, 7, 0, 0, 0, 0, 5, -100, 13, 3, 0, 0, 0, 0, 0, 0, 0, 7, 13, -6, 3, 0, 0, 0, 0, 0, 9, -8, 5, 0, 0, 0, 1, -100, -2, 11, 0, 0, 0, 0, 0, 3, -8, 9, 0, 0, 0, 0, 7, -9, 11, 0, 0, 0, 0, -100, -3, 3, 0, 0, 0, 0, 7, -8, 13, 0, 0, 0, 0, -10, 11, 0, 0, 0, 0, -100, -3, 7, 0, 0, 0, 0, 11, -9, 0, 0, 0, 0, -10, 11, 0, 0, 0, 1, -100, -3, 11, 0, 0, 0, 0, 11, -9, 0, 0, 0, 0, -10, 11, 0, 0, 0, 3, -100, -3, 13, 0, 0, 0, 0, 11, -8, 13, 0, 0, 0, 0, -10, 11, 0, 0, 0, 5, -100, -3, 13, 0, 0, 0, 0, 11, -8, 11, 0, 0, 0, 0, -10, 11, 0, 0, 0, 5, -100, -4, 0, 0, 0, 0, 13, -8, 9, 0, 0, 0, 0, -10, 11, 0, 0, 0, 5, -100, -4, 0, 0, 0, 0, 13, -8, 11, 0, 0, 0, 0, -10, 11, 0, 0, 0, 3, -100, -4, 0, 0, 0, 0, 13, -8, 11, 0, 0, 0, 0, -10, 11, 0, 0, 0, 0, -100, -3, 13, 0, 0, 0, 1, -9, 13, 0, 0, 0, 0, -10, 11, 0, 0, 0, 0, -100, -3, 11, 0, 0, 0, 13, -10, 0, 0, 0, 0, -10, 11, 0, 0, 0, 0, -100, -4, 0, 0, 0, 11, -10, 0, 0, 0, 0, -10, 11, 0, 0, 0, 0, -100, -3, 13, 0, 0, 0, 3, -9, 13, 0, 0, 0, 0, 13, -9, 9, 0, 0, 0, 0, -100, -3, 7, 0, 0, 0, 0, 13, -8, 11, 0, 0, 0, 0, 11, -9, 7, 0, 0, 0, 0, 13, -100, -3, 3, 0, 0, 0, 0, 9, -8, 5, 0, 0, 0, 0, 5, -9, 5, 0, 0, 0, 0, 7, -100, -1, 13, 3, 0, 0, 0, 0, 0, 1, 11, -6, 9, 0, 0, 0, 0, 0, 0, 3, -7, 11, 1, 0, 0, 0, 0, 1, 13, -100, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, -4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 5, -5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, 13, 1, 0, 0, 0, 0, 0, 0, 0, 1, 9, -4, 1, 0, 0, 0, 0, 0, 0, 0, 1, 5, -5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 7, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt13 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -3, 13, 7, 3, 0, 13, -5, 13, 7, 1, 0, 0, 3, 7, -100, -2, 5, 0, 0, 0, 0, -4, 13, 3, 0, 0, 0, 0, 0, 0, 0, 7, -100, 7, 1, 0, 0, 0, 0, 0, -3, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, -100, 1, 0, 0, 0, 0, 0, 0, 13, 9, 1, 0, 5, 11, 13, -1, 11, 3, 0, 0, 0, 0, 9, -100, 13, 3, 0, 0, 0, 0, 0, 1, 1, 7, -7, 3, 0, 0, 0, 3, -100, -2, 1, 0, 0, 0, 0, 7, -9, 13, 0, 0, 0, 1, -100, -2, 7, 0, 0, 0, 0, -11, 1, 0, 0, 0, -100, -2, 9, 0, 0, 0, 0, -11, 1, 0, 0, 0, 13, -100, -2, 11, 0, 0, 0, 0, -11, 3, 0, 0, 0, 13, -100, -2, 11, 0, 0, 0, 0, -11, 5, 0, 0, 0, 11, -100, -2, 11, 0, 0, 0, 0, -11, 3, 0, 0, 0, 11, -100, -2, 11, 0, 0, 0, 0, -11, 1, 0, 0, 0, 11, -100, -2, 11, 0, 0, 0, 0, -11, 0, 0, 0, 0, 11, -100, -2, 11, 0, 0, 0, 0, -11, 0, 0, 0, 0, 11, -100, -2, 11, 0, 0, 0, 0, -11, 1, 0, 0, 0, 11, -100, -2, 11, 0, 0, 0, 0, -11, 3, 0, 0, 0, 11, -100, -2, 11, 0, 0, 0, 0, -11, 3, 0, 0, 0, 11, -100, -2, 11, 0, 0, 0, 0, 13, -10, 5, 0, 0, 0, 11, -100, -2, 11, 0, 0, 0, 0, 13, -10, 5, 0, 0, 0, 11, -100, -2, 11, 0, 0, 0, 0, 9, -10, 5, 0, 0, 0, 9, -100, -2, 7, 0, 0, 0, 0, 5, -10, 3, 0, 0, 0, 7, -100, -1, 13, 1, 0, 0, 0, 0, 1, 11, -7, 11, 5, 0, 0, 0, 0, 0, 3, 9, -100, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 3, -4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, -100, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, -4, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt14 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -7, 13, 7, 3, 1, 0, 0, 1, 5, 9, -100, -6, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 7, -100, -4, 11, 1, 0, 0, 1, 9, 13, -1, 13, 11, 5, 0, 0, 0, 3, 13, -100, -3, 11, 0, 0, 0, 3, 13, -6, 13, 1, 0, 0, 0, 13, -100, -2, 11, 0, 0, 0, 1, 13, -8, 13, 0, 0, 0, 5, -100, -2, 0, 0, 0, 0, 9, -10, 5, 0, 0, 0, 11, -100, -1, 7, 0, 0, 0, 1, -11, 13, 0, 0, 0, 1, -100, -1, 1, 0, 0, 0, 5, -12, 1, 0, 0, 0, 9, -100, 11, 0, 0, 0, 0, 11, -12, 5, 0, 0, 0, 3, -100, 7, 0, 0, 0, 0, 13, -12, 9, 0, 0, 0, 0, -100, 3, 0, 0, 0, 0, 13, -12, 11, 0, 0, 0, 0, -100, 1, 0, 0, 0, 0, -13, 11, 0, 0, 0, 1, -100, 0, 0, 0, 0, 0, -13, 11, 0, 0, 0, 1, -100, 0, 0, 0, 0, 0, 13, -12, 11, 0, 0, 0, 0, -100, 1, 0, 0, 0, 0, 13, -12, 9, 0, 0, 0, 1, -100, 5, 0, 0, 0, 0, 11, -12, 5, 0, 0, 0, 3, -100, 9, 0, 0, 0, 0, 9, -12, 3, 0, 0, 0, 7, -100, -1, 1, 0, 0, 0, 5, -12, 0, 0, 0, 0, 11, -100, -1, 9, 0, 0, 0, 3, -11, 13, 0, 0, 0, 3, -100, -2, 3, 0, 0, 0, 13, -10, 7, 0, 0, 0, 11, -100, -2, 13, 1, 0, 0, 3, -9, 13, 0, 0, 0, 7, -100, -3, 13, 1, 0, 0, 3, 13, -6, 13, 1, 0, 0, 5, -100, -4, 13, 1, 0, 0, 1, 7, 13, -3, 9, 0, 0, 0, 7, -100, -6, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 11, -100, -7, 13, 7, 3, 0, 0, 0, 0, 3, 11, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt15 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -6, 11, 7, -100, -4, 11, 3, 0, 0, 7, 11, 5, 3, 0, 0, 0, 1, 5, 9, -100, -2, 11, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, -100, 13, 5, 0, 0, 0, 0, 0, 0, 0, 1, 7, 11, 13, -1, 13, 3, 0, 0, 0, 5, -100, 1, 0, 0, 0, 0, 0, 0, 0, 3, -7, 7, 0, 0, 0, 7, -100, 1, 0, 0, 0, 0, 0, 0, 0, 11, -8, 7, 0, 0, 0, 13, -100, -1, 11, 5, 0, 0, 0, 0, 0, 11, -9, 1, 0, 0, 3, -100, -3, 7, 0, 0, 0, 0, 11, -9, 5, 0, 0, 0, 11, -100, -3, 9, 0, 0, 0, 0, 11, -9, 9, 0, 0, 0, 5, -100, -3, 11, 0, 0, 0, 0, 11, -9, 11, 0, 0, 0, 0, 13, -100, -3, 11, 0, 0, 0, 0, 11, -9, 13, 0, 0, 0, 0, 11, -100, -3, 13, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -3, 13, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -3, 13, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 13, -100, -4, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 13, -100, -4, 0, 0, 0, 0, 13, -10, 0, 0, 0, 0, -100, -4, 0, 0, 0, 9, -11, 0, 0, 0, 3, -100, -4, 0, 0, 0, 3, -11, 0, 0, 0, 9, -100, -4, 0, 0, 0, 0, 13, -10, 0, 0, 0, 13, -100, -4, 0, 0, 0, 0, 11, -9, 5, 0, 0, 0, -100, -4, 0, 0, 0, 0, 11, -8, 7, 0, 0, 0, 7, -100, -4, 0, 0, 0, 0, 5, -7, 9, 0, 0, 0, 3, -100, -4, 0, 0, 0, 0, 0, 3, 11, 13, -3, 9, 0, 0, 0, 1, -100, -4, 0, 0, 0, 0, 5, 7, 0, 0, 0, 1, 1, 0, 0, 0, 1, 13, -100, -4, 0, 0, 0, 0, 11, -2, 9, 5, 1, 0, 0, 3, 7, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 7, -100, -4, 0, 0, 0, 0, 3, -100, -3, 7, 0, 0, 0, 0, 0, 9, -100, -1, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, -100, -1, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, -100, -101],
  lt16 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -19, 7, 11, -100, -6, 11, 5, 1, 0, 0, 1, 5, 11, -4, 5, 0, 3, -100, -4, 13, 3, 0, 0, 0, 0, 0, 0, 0, 0, 1, 11, 13, 5, 0, 0, 1, -100, -3, 13, 1, 0, 0, 1, 5, 11, -3, 11, 3, 0, 0, 0, 0, 0, 3, -100, -2, 13, 1, 0, 0, 3, -8, 3, 0, 0, 0, 0, 5, -100, -1, 13, 1, 0, 0, 0, 13, -8, 7, 0, 0, 0, 0, 5, -100, -1, 3, 0, 0, 0, 5, -9, 11, 0, 0, 0, 0, 7, -100, 9, 0, 0, 0, 0, 11, -9, 13, 0, 0, 0, 0, 9, -100, 3, 0, 0, 0, 0, -10, 13, 0, 0, 0, 0, 9, -100, 1, 0, 0, 0, 1, -11, 0, 0, 0, 0, 9, -100, 0, 0, 0, 0, 3, -11, 0, 0, 0, 0, 11, -100, 0, 0, 0, 0, 5, -11, 0, 0, 0, 0, 11, -100, 0, 0, 0, 0, 9, -11, 0, 0, 0, 0, 11, -100, 0, 0, 0, 0, 11, -11, 0, 0, 0, 0, 11, -100, 0, 0, 0, 0, 11, -11, 0, 0, 0, 0, 11, -100, 1, 0, 0, 0, 11, -11, 0, 0, 0, 0, 11, -100, 3, 0, 0, 0, 9, -11, 0, 0, 0, 0, 11, -100, 7, 0, 0, 0, 5, -11, 0, 0, 0, 0, 11, -100, 11, 0, 0, 0, 0, -11, 0, 0, 0, 0, 11, -100, -1, 1, 0, 0, 0, 7, -9, 11, 0, 0, 0, 0, 11, -100, -1, 9, 0, 0, 0, 0, 13, -8, 9, 0, 0, 0, 0, 11, -100, -2, 3, 0, 0, 0, 1, 13, -7, 5, 0, 0, 0, 0, 11, -100, -2, 13, 3, 0, 0, 0, 1, 9, 13, -3, 13, 7, 0, 0, 0, 0, 0, 11, -100, -4, 9, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 11, -100, -6, 11, 7, 3, 1, 0, 0, 5, 9, -1, 13, 0, 0, 0, 0, 11, -100, -16, 0, 0, 0, 0, 13, -100, -16, 0, 0, 0, 0, 13, -100, -16, 0, 0, 0, 0, 13, -100, -16, 0, 0, 0, 0, 13, -100, -15, 13, 0, 0, 0, 0, 13, -100, -15, 9, 0, 0, 0, 0, 11, -100, -15, 1, 0, 0, 0, 0, 5, -100, -12, 7, 5, 1, 0, 0, 0, 0, 0, 0, 1, 3, 9, -100, -11, 13, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, -100, -101],
  lt17 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -3, 13, 5, 0, 3, -5, 9, 3, 1, 0, 0, 3, -100, -1, 11, 3, 0, 0, 0, 0, -3, 7, 0, 0, 0, 0, 0, 0, 0, 5, -100, 9, 0, 0, 0, 0, 0, 0, -2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 1, -100, 0, 0, 0, 0, 0, 0, 0, 11, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -100, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, -1, 7, 0, 0, 0, 0, 0, 0, 7, 13, -2, 11, 7, 3, 1, 3, 11, -100, -2, 3, 0, 0, 0, 0, 3, -100, -2, 7, 0, 0, 0, 0, 9, -100, -2, 11, 0, 0, 0, 0, 13, -100, -2, 13, 0, 0, 0, 0, -100, -3, 0, 0, 0, 0, -100, -3, 0, 0, 0, 0, 13, -100, -3, 0, 0, 0, 0, 13, -100, -3, 0, 0, 0, 0, 13, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 11, -100, -3, 0, 0, 0, 0, 9, -100, -1, 13, 3, 0, 0, 0, 0, 1, 13, -100, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, -100, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 3, 13, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt18 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -3, 13, 7, 1, 0, 1, 3, 9, 11, 9, 9, 13, -100, -2, 13, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, -100, -2, 1, 0, 5, 13, -1, 13, 11, 3, 0, 0, 0, 1, -100, -1, 9, 0, 1, -6, 9, 0, 0, 0, 13, -100, -1, 3, 0, 9, -7, 11, 1, 0, 9, -100, -1, 0, 0, -9, 13, 1, 5, -100, -1, 0, 0, 11, -9, 13, 11, -100, 13, 0, 0, 1, 13, -100, 13, 0, 0, 0, 1, 9, -100, -1, 0, 0, 0, 0, 0, 0, 5, 9, -100, -1, 5, 0, 0, 0, 0, 0, 0, 0, 1, 7, 13, -100, -1, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, -2, 13, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, -100, -4, 11, 5, 0, 0, 0, 0, 0, 0, 0, 0, 7, -100, -7, 9, 5, 0, 0, 0, 0, 0, 0, 13, -100, -9, 13, 7, 0, 0, 0, 0, 7, -100, -11, 13, 3, 0, 0, 3, -100, -13, 0, 0, 0, -100, 7, 5, -11, 1, 0, 0, -100, 1, 0, 5, -10, 1, 0, 3, -100, 0, 0, 0, 3, -9, 0, 0, 9, -100, 1, 0, 0, 0, 3, 13, -6, 5, 0, 3, -100, 7, 0, 0, 0, 0, 1, 7, 11, 13, 13, 9, 3, 0, 1, 13, -100, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 13, -100, -1, 5, 3, 9, 7, 3, 1, 0, 0, 1, 5, 11, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt19 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -6, 5, 0, 5, -100, -5, 13, 0, 0, 0, 7, -100, -5, 7, 0, 0, 0, 9, -100, -5, 3, 0, 0, 0, 13, -100, -4, 11, 0, 0, 0, 0, -100, -4, 3, 0, 0, 0, 0, -100, -3, 5, 0, 0, 0, 0, 1, -100, -2, 3, 0, 0, 0, 0, 0, 7, -100, 13, 1, 0, 0, 0, 0, 0, 0, 1, 11, -100, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 13, -100, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, -100, -3, 9, 0, 0, 0, 0, 7, 13, -100, -4, 0, 0, 0, 0, 11, -100, -4, 1, 0, 0, 0, 11, -100, -4, 1, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -100, -4, 1, 0, 0, 0, 11, -100, -4, 3, 0, 0, 0, 11, -100, -4, 5, 0, 0, 0, 11, -100, -4, 3, 0, 0, 0, 11, -100, -4, 3, 0, 0, 0, 11, -100, -4, 1, 0, 0, 0, 9, -100, -4, 0, 0, 0, 0, 5, -100, -4, 0, 0, 0, 0, 1, -100, -4, 1, 0, 0, 0, 0, 11, -100, -4, 3, 0, 0, 0, 0, 1, 13, -1, 9, 5, 1, 3, -100, -4, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, -100, -5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 5, -100, -6, 9, 3, 1, 0, 0, 1, 5, 11, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt20 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -4, 13, 9, 1, 0, 13, -11, 11, 5, 1, 5, -100, -2, 11, 3, 0, 0, 0, 0, 11, -8, 11, 5, 0, 0, 0, 0, 1, -100, 13, 3, 0, 0, 0, 0, 0, 0, 11, -6, 7, 1, 0, 0, 0, 0, 0, 0, 7, -100, 5, 0, 0, 0, 0, 0, 0, 0, 11, -5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 11, -100, 11, 1, 0, 0, 0, 0, 0, 0, 11, -5, 9, 0, 0, 0, 0, 0, 0, 0, 0, 11, -100, -2, 11, 1, 0, 0, 0, 0, 11, -6, 13, 7, 3, 0, 0, 0, 0, 0, 11, -100, -3, 9, 0, 0, 0, 0, 11, -9, 9, 0, 0, 0, 0, 11, -100, -3, 11, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -3, 13, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -4, 0, 0, 0, 0, 11, -10, 0, 0, 0, 0, 11, -100, -4, 1, 0, 0, 0, 11, -9, 13, 0, 0, 0, 0, 11, -100, -4, 1, 0, 0, 0, 11, -9, 5, 0, 0, 0, 0, 11, -100, -4, 5, 0, 0, 0, 7, -8, 7, 0, 0, 0, 0, 0, 11, -100, -4, 7, 0, 0, 0, 0, 13, -5, 13, 5, 0, 0, 0, 0, 0, 0, 11, -100, -4, 13, 0, 0, 0, 0, 1, 11, -1, 13, 11, 5, 0, 0, 7, 5, 0, 0, 0, 0, 3, 13, -100, -5, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 13, -2, 0, 0, 0, 0, 0, 0, 7, -100, -5, 11, 0, 0, 0, 0, 0, 0, 0, 1, 9, -4, 0, 0, 0, 0, 0, 0, 0, -100, -6, 13, 5, 1, 0, 1, 3, 9, -6, 3, 1, 3, 7, 9, 11, 13, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt21 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -6, 13, 9, 1, 3, 13, -5, 13, 1, 0, 0, 0, 0, 1, 3, 9, -100, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, -5, 3, 0, 0, 0, 0, 0, 0, 0, 0, 13, -100, -1, 9, 3, 0, 0, 0, 0, 0, 5, 13, -7, 13, 9, 0, 0, 0, 0, 1, 11, -100, -3, 7, 0, 0, 0, 0, -11, 7, 0, 0, 5, -100, -4, 0, 0, 0, 0, 9, -10, 9, 0, 5, -100, -4, 5, 0, 0, 0, 1, -10, 5, 0, 11, -100, -4, 11, 0, 0, 0, 0, 9, -9, 0, 1, -100, -5, 1, 0, 0, 0, 3, -8, 9, 0, 7, -100, -5, 7, 0, 0, 0, 0, 13, -7, 3, 0, 13, -100, -5, 13, 0, 0, 0, 0, 7, -6, 13, 0, 3, -100, -6, 3, 0, 0, 0, 1, -6, 7, 0, 11, -100, -6, 9, 0, 0, 0, 0, 9, -5, 0, 1, -100, -6, 13, 0, 0, 0, 0, 3, -4, 7, 0, 7, -100, -7, 5, 0, 0, 0, 0, 11, -3, 1, 0, 13, -100, -7, 11, 0, 0, 0, 0, 1, -2, 9, 0, 5, -100, -8, 1, 0, 0, 0, 0, 5, -1, 1, 0, 11, -100, -8, 7, 0, 0, 0, 0, 0, 0, 0, 3, -100, -8, 13, 0, 0, 0, 0, 0, 0, 0, 9, -100, -9, 3, 0, 0, 0, 0, 0, 1, -100, -9, 9, 0, 0, 0, 0, 0, 7, -100, -10, 0, 0, 0, 0, 0, 13, -100, -10, 5, 0, 0, 0, 1, -100, -10, 13, 1, 0, 0, 7, -100, -11, 11, 1, 5, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt22 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -29, 13, -100, 5, 0, 0, 1, 1, 1, 3, 3, 5, 7, -3, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, -4, 3, 0, 0, 0, 0, 0, 0, 1, 3, 11, -100, 5, 0, 0, 0, 0, 0, 0, 0, 1, 7, -3, 9, 0, 0, 0, 0, 0, 0, 0, 0, 1, 11, -4, 9, 1, 0, 0, 0, 0, 0, 0, 1, 13, -100, -1, 13, 5, 0, 0, 0, 0, 0, 13, -5, 13, 5, 0, 0, 0, 0, 0, 3, -8, 9, 0, 0, 0, 0, 5, -100, -3, 5, 0, 0, 0, 0, -8, 11, 0, 0, 0, 0, 9, -9, 9, 0, 0, 9, -100, -4, 1, 0, 0, 0, 13, -8, 11, 0, 0, 0, 3, -10, 0, 3, -100, -4, 7, 0, 0, 0, 11, -8, 13, 0, 0, 0, 0, 13, -8, 9, 0, 11, -100, -4, 13, 0, 0, 0, 7, -8, 11, 0, 0, 0, 0, 7, -8, 1, 1, -100, -5, 5, 0, 0, 1, -8, 7, 0, 0, 0, 0, 3, -8, 5, 11, -100, -5, 11, 0, 0, 0, 9, -7, 1, 0, 0, 0, 0, 0, 13, -100, -6, 0, 0, 0, 3, -6, 9, 0, 3, 13, 0, 0, 0, 7, -6, 5, -100, -6, 3, 0, 0, 0, 13, -5, 1, 0, 11, -1, 3, 0, 0, 3, -6, 1, -100, -6, 9, 0, 0, 0, 9, -4, 11, 0, 3, -2, 7, 0, 0, 0, 13, -4, 11, 1, -100, -6, 13, 0, 0, 0, 3, -4, 5, 0, 9, -2, 13, 0, 0, 0, 7, -4, 5, 3, -100, -7, 3, 0, 0, 0, 13, -3, 1, 1, -4, 0, 0, 0, 1, -4, 1, 7, -100, -7, 9, 0, 0, 0, 5, -2, 13, 0, 7, -4, 5, 0, 0, 0, 9, -2, 9, 0, 13, -100, -8, 1, 0, 0, 0, 13, -1, 7, 1, -5, 11, 0, 0, 0, 1, -2, 1, 3, -100, -8, 7, 0, 0, 0, 1, 13, 1, 5, -6, 1, 0, 0, 0, 13, 9, 0, 9, -100, -8, 13, 0, 0, 0, 0, 0, 0, 11, -6, 7, 0, 0, 0, 1, 0, 1, -100, -9, 3, 0, 0, 0, 0, 3, -7, 13, 0, 0, 0, 0, 0, 9, -100, -9, 9, 0, 0, 0, 0, 5, -8, 3, 0, 0, 0, 0, 13, -100, -9, 13, 0, 0, 0, 0, 11, -8, 9, 0, 0, 0, 1, -100, -10, 3, 0, 0, 0, -10, 3, 0, 0, 5, -100, -10, 11, 0, 0, 7, -10, 13, 1, 1, 13, -100, -11, 11, 11, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt23 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -16, 13, 13, -1, 13, 9, 5, 1, 0, 1, 5, 13, -100, -1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 1, 7, -4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -100, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 11, -4, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, -100, -2, 13, 7, 0, 0, 0, 0, 0, 0, 13, -6, 13, 5, 0, 0, 0, 0, 5, 9, 13, -100, -4, 13, 3, 0, 0, 0, 0, 3, -7, 13, 0, 0, 5, 13, -100, -6, 3, 0, 0, 0, 0, 5, -6, 7, 0, 7, -100, -7, 3, 0, 0, 0, 0, 11, -4, 11, 0, 9, -100, -8, 5, 0, 0, 0, 1, -3, 11, 0, 7, -100, -9, 3, 0, 0, 0, 1, 11, 11, 0, 7, -100, -9, 13, 1, 0, 0, 0, 0, 0, 7, -100, -10, 13, 1, 0, 0, 0, 0, 9, -100, -11, 11, 0, 0, 0, 0, 1, -100, -12, 0, 0, 0, 0, 0, 7, -100, -11, 9, 0, 0, 0, 0, 0, 0, 11, -100, -10, 9, 0, 5, 13, 3, 0, 0, 0, 1, 13, -100, -9, 11, 0, 3, -2, 13, 1, 0, 0, 0, 1, 13, -100, -8, 11, 0, 3, 13, -3, 13, 1, 0, 0, 0, 1, 13, -100, -7, 9, 0, 1, 13, -5, 11, 0, 0, 0, 0, 1, 13, -100, -6, 9, 0, 0, 7, -7, 9, 0, 0, 0, 0, 1, 11, -100, -5, 5, 0, 0, 0, 13, -8, 7, 0, 0, 0, 0, 0, 9, -100, -3, 13, 3, 0, 0, 0, 0, 13, -8, 13, 0, 0, 0, 0, 0, 0, 5, -100, 9, 3, 1, 0, 0, 0, 0, 0, 0, 1, 11, -6, 11, 1, 0, 0, 0, 0, 0, 0, 0, 1, 3, 13, -100, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, -6, 11, 5, 3, 1, 0, 0, 0, 1, 1, 3, 5, -100, 13, 13, 13, 13, -100, -100, -100, -100, -100, -100, -100, -100, -100, -101],
  lt24 = [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -1, 13, 13, -2, 13, 13, 11, 11, 11, 13, -6, 11, 11, 11, 11, 11, 11, 11, 11, 13, -100, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, -4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, -100, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, -4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 9, -100, -2, 11, 5, 0, 0, 0, 0, 0, 0, 11, -6, 11, 0, 0, 0, 0, 1, 7, 13, -100, -4, 11, 0, 0, 0, 0, 0, -8, 9, 0, 0, 1, 13, -100, -5, 7, 0, 0, 0, 0, 13, -7, 9, 0, 0, 13, -100, -6, 1, 0, 0, 0, 9, -7, 5, 0, 5, -100, -6, 7, 0, 0, 0, 3, -7, 1, 0, 13, -100, -6, 13, 0, 0, 0, 0, 13, -5, 11, 0, 1, -100, -7, 5, 0, 0, 0, 7, -5, 7, 0, 7, -100, -7, 11, 0, 0, 0, 3, -5, 1, 0, 11, -100, -8, 1, 0, 0, 0, 13, -3, 13, 0, 3, -100, -8, 7, 0, 0, 0, 7, -3, 7, 0, 9, -100, -8, 13, 0, 0, 0, 3, -3, 1, 1, -100, -9, 5, 0, 0, 0, 13, -1, 9, 0, 7, -100, -9, 11, 0, 0, 0, 3, 13, 1, 0, 13, -100, -10, 1, 0, 0, 0, 0, 0, 3, -100, -10, 9, 0, 0, 0, 0, 0, 9, -100, -11, 1, 0, 0, 0, 1, -100, -11, 5, 0, 0, 0, 7, -100, -11, 9, 0, 0, 0, 13, -100, -11, 13, 0, 0, 3, -100, -12, 0, 0, 9, -100, -12, 0, 1, -100, -11, 13, 0, 7, -100, -11, 7, 0, 11, -100, -11, 1, 0, -100, -2, 7, 0, 1, 7, -4, 11, 0, 3, -100, -1, 11, 0, 0, 0, 0, 1, 9, 13, 11, 1, 0, 9, -100, -1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, -100, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 13, -100, -1, 7, 0, 0, 0, 0, 0, 0, 0, 1, 13, -100, -2, 9, 3, 0, 0, 1, 3, 7, -100, -101],
  lt = [lt0, lt1, lt2, lt3, lt0, lt5, lt0, lt7, lt8, lt9, lt10, lt11, lt12, lt13, lt14, lt15, lt16, lt17, lt18, lt19, lt20, lt21, lt22, lt23, lt24],
  SW = [0, 4, 8, 12, 16, 20, 23, 27, 31, 35, 39, 43, 47, 50, 54, 58, 61, 65, 68, 71, 75, 78, 81, 84, 87, 90, 93, 96, 98, 101, 103, 105, 108, 110, 112, 114, 115, 117, 119, 120, 121, 122, 123, 124, 125, 126, 126, 127, 127, 127, 127, 127, 127, 127, 126, 126, 125, 124, 123, 122, 121, 120, 119, 117, 115, 114, 112, 110, 108, 105, 103, 101, 98, 96, 93, 90, 87, 84, 81, 78, 75, 71, 68, 65, 61, 58, 54, 50, 47, 43, 39, 35, 31, 27, 23, 20, 16, 12, 8, 4, 0, -4, -8, -12, -16, -20, -23, -27, -31, -35, -39, -43, -47, -50, -54, -58, -61, -65, -68, -71, -75, -78, -81, -84, -87, -90, -93, -96, -98, -101, -103, -105, -108, -110, -112, -114, -115, -117, -119, -120, -121, -122, -123, -124, -125, -126, -126, -127, -127, -127, -127, -127, -127, -127, -126, -126, -125, -124, -123, -122, -121, -120, -119, -117, -115, -114, -112, -110, -108, -105, -103, -101, -98, -96, -93, -90, -87, -84, -81, -78, -75, -71, -68, -65, -61, -58, -54, -50, -47, -43, -39, -35, -31, -27, -23, -20, -16, -12, -8, -4],
  SIZE = 4,
  NDOTS = 100,
  GIF_SIZE = 17646,
  LETTERS = "abcdafahijklmnopqrstuvwxyz";

function urandom(size) {
  return new Promise((resolve, reject) => {
    crypto.randomBytes(size, (err, buf) => {
      err ? reject(err) : resolve(buf);
    });
  });
}

function random(min, max) {
  return Math.floor(Math.random() * (max - min)) + min;
}

function letter(n, pos, im, swr, s1, s2) {
  let l = im.length,
    t = lt[n],
    r = 3200 + pos,
    i = r,
    sk1 = s1 + pos,
    sk2 = s2 + pos,
    mpos = pos,
    row = 0;
  for (let j = 0, k = t.length; j < k; j++) {
    let p = t[j];
    if (-101 === p) continue;
    if (p < 0) {
      if (-100 === p) {
        r += 200, i = r, sk1 = s1 + pos, row++;
        continue;
      }
      i += -p;
      continue;
    }
    sk1 >= 200 && (sk1 %= 200);
    let skew = Math.floor(SW[sk1] / 16);
    sk1 += 1 + (1 & swr[pos + i - r]), sk2 >= 200 && (sk2 %= 200);
    let skewh = Math.floor(SW[sk2] / 70);
    sk2 += 1 & swr[row];
    let x = i + 200 * skew + skewh;
    mpos = Math.max(mpos, pos + i - r), x - l < 14e3 && (im[x] = p << 4), i++;
  }
  return mpos;
}

function line(im, swr, s1) {
  for (let x = 0, sk1 = s1; x < 199; x++) {
    sk1 >= 200 && (sk1 %= 200);
    let skew = Math.floor(SW[sk1] / 16);
    sk1 += 1 + (3 & swr[x]);
    let i = 200 * (45 + skew) + x;
    im[i + 0] = 0, im[i + 1] = 0, im[i + 200] = 0, im[i + 201] = 0;
  }
}

function dots(im, dr) {
  for (let n = 0; n < NDOTS; n++) {
    let i = dr.readUInt32BE(n) % 13400;
    im[i + 0] = 255, im[i + 1] = 255, im[i + 2] = 255, im[i + 200] = 255, im[i + 201] = 255,
      im[i + 202] = 255;
  }
}

function blur(im) {
  for (let i = 0, y = 0; y < 68; y++)
    for (let x = 0; x < 198; x++) {
      let c11 = im[i + 0],
        c12 = im[i + 1],
        c21 = im[i + 200],
        c22 = im[i + 201];
      im[i++] = Math.floor((c11 + c12 + c21 + c22) / 4);
    }
}

function filter(im) {
  const om = Buffer.alloc(14e3).fill(255);
  let i = 0,
    o = 0;
  for (let y = 0; y < 70; y++)
    for (let x = 4; x < 196; x++)(im[i] > 240 && im[i + 1] < 240 || im[i] < 240 && im[i + 1] > 240) && (om[o] = 0, om[o + 1] = 0), i++, o++;
  om.copy(im);
}
async function captcha(size) {
  const rb = await urandom(size + 200 + 400 + 1 + 1),
    l = Buffer.alloc(size),
    swr = Buffer.alloc(200),
    dr = Buffer.alloc(400);
  let s1, s2;
  rb.copy(l, 0, 0, size), rb.copy(swr, 0, size, size + 200), rb.copy(dr, 0, size + 200, size + 200 + 400),
    s1 = rb.readUInt8(size + 200 + 400), s2 = rb.readUInt8(size + 200 + 400 + 1);
  const im = Buffer.alloc(14e3).fill(255);
  s1 &= 127, s2 &= 63;
  let p = 30;
  for (let n = 0; n < size; n++) l[n] %= 25, p = letter(l[n], p, im, swr, s1, s2),
    l[n] = LETTERS.charCodeAt(l[n]);
  return line(im, swr, s1), dots(im, dr), {
    im: im,
    l: l
  };
}

function makegif(im, gif, style) {
  let r = -1 === style ? random(0, colors.length) : style;
  gif.fill(colors[r].replace(/\n/g, ""), 0, 72, "ascii");
  let i = 0,
    p = 72;
  for (let y = 0; y < 70; y++) {
    gif[p++] = 250;
    for (let x = 0; x < 50; x++) {
      let a = im[i + 0] >> 4,
        b = im[i + 1] >> 4,
        c = im[i + 2] >> 4,
        d = im[i + 3] >> 4;
      gif[p + 0] = 16 | a << 5, gif[p + 1] = a >> 3 | 64 | b << 7, gif[p + 2] = b >> 1,
        gif[p + 3] = 1 | c << 1, gif[p + 4] = 4 | d << 3, i += 4, p += 5;
    }
  }
  gif.fill("\0;", 17642);
}
async function convertGifToPng(gifBuffer) {
  try {
    return await sharp(gifBuffer).png().toBuffer();
  } catch (error) {
    throw console.error("Error converting GIF to PNG:", error), error;
  }
}
export const generateV2 = async ({
  size = 4,
  style = -1
} = {}) => {
  try {
    const gif = Buffer.alloc(17646),
      {
        im,
        l
      } = await captcha(size);
    return makegif(im, gif, style), {
      buffer: await convertGifToPng(gif),
      code: l.toString()
    };
  } catch (error) {
    throw console.error("Error generating CAPTCHA:", error), new Error("Failed to generate CAPTCHA");
  }
};
